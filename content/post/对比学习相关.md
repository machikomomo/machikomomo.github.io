---
author: "momo"
date: 2022-05-09
title: "对比学习相关和思考"
categories: [
    "论文笔记",
    "医学图像分析",
    "CVPR",
]

---


## ContrastiveCrop

**Crafting Better Contrastive Views for Siamese Representation Learning**

CVPR 2022

- Paper: https://arxiv.org/abs/2202.03278
- Code: https://github.com/xyupeng/ContrastiveCrop
- 中文解读：https://mp.weixin.qq.com/s/VTP9D5f7KG9vg30U9kVI2A

动机：目前主流的对比学习方法均采用孪生网络(Siamese network)的架构，这不可避免地带来一个问题，就是如何选取作为孪生网络输入的训练样本对。之前的工作已经指出，数据增强操作对于达到好的对比学习性能是至关重要的。然而，却鲜有工作考虑到样本对中两个图片块(crop)的选取。基于此，本文重新审视了传统使用的RandomCrop，指出了其在对比学习中的缺陷，并进一步为对比学习设计了新的裁剪策略，命名为“对比裁剪(ContrastiveCrop)”。**ContrastiveCrop旨在确保大部分正样本对语义一致的前提下，加大样本之间的差异性，从而通过最小化对比损失学习到更泛化的特征**。ContrastiveCrop完全即插即用，且**理论上适用于任何孪生网络架构**。广泛的实验表明，在几乎不增加训练内存和计算代价的前提下，ContrastiveCrop能够在若干常用数据集上稳定提升当前主流对比学习方法的性能。

![图片](https://halfbit.oss-cn-hangzhou.aliyuncs.com/tts.png)

ContrastiveCrop首先需要对物体轮廓进行大致的定位(Semantic-aware Localization上图虚线框)，并由此来指导crops的选取。这样确保了大部分情况crop不会错失前景物体而造成错误的正样本对(如上图(b)避免了(a)中纯背景采样的情况)。在定位的基础上，ContrastiveCrop采用了中心压制的非均匀分布进行采样(Center-suppressed Sampling)，增加了多次采样之间的方差，从而增大了不同crops之间的差异性(如上图(d)相比于(c)生成的crops差异性更大)。综合来说，**ContrastiveCrop能够为对比学习提供语义信息一致而差异性更大的样本对，从而提升对比学习表征的泛化性**。

**启发**

两个优点：1.对目标的大致定位，减少引入背景/其他目标的噪声；2.在定位的基础上，样本对的差异性更大。

类似思路：1、优化输入的数据增强的这个模块，可以改动成比如，注意力引导的；2、根据图片的特点（比如病理图片）采用特定的数据增强的方法（扭曲、直方图等）。

## DIRA

**DiRA: Discriminative, Restorative, and Adversarial Learning for Self-supervised Medical Image Analysis**

CVPR 2022

- Paper: https://arxiv.org/abs/2204.10437（https://arxiv.org/pdf/2204.10437.pdf)
- Code: https://github.com/JLiangLab/DiRA

摘要：把自监督领域的discriminative（鉴别性）, restorative（恢复性）, and adversarial learning（对抗性）学习（以上三个方法都用于representation的学习）协同联合利用起来，(1) 鼓励三种学习成分之间的协作学习，从而在不同器官、疾病和模式之间产生更多的通用表示。(2) 优于完全监督的ImageNet模型，并在小数据环境下提高了鲁棒性，降低了多种医学影像应用的注释成本。(3) 学习细粒度的语义表征，只用图像级别的注释就能促进准确的病变定位；以及(4) 增强了最先进的恢复性方法，揭示了DiRA是一个联合表征学习的通用机制。

![](https://halfbit.oss-cn-hangzhou.aliyuncs.com/hao.png)

（摘抄）摄影图像通常有大的前景物体，有明显的辨别部分，而医学图像包含一致的解剖结构，语义信息分散在整个图像上。因此，摄影图像的识别任务主要是基于高层次的特征，而医学任务则需要在整个图像中捕获整体的细粒度的鉴别特征。

Importantly, medical tasks require much stronger attention to fine-grained details within images as identifying diseases, delineating organs, and isolating lesions rely on subtle, local variations in texture [29]. Therefore, recognition tasks in medical images desire complementary high-level and fine-grained discriminative features captured throughout images.

作者认为三种获得representation的方式的各自特点：（1）鉴别性学习擅长捕捉高层次（全局）的鉴别性特征，（2）恢复性学习擅长保存嵌入在局部图像区域的细微细节，以及 (3)对抗性学习通过保护更多细粒度的细节来巩固恢复性。

医学成像中的自我监督学习。1.最近的判别方法集中在实例级判别上。在[29]中，一项全面的基准研究评估了在ImageNet上预训练的现有实例判别方法在不同医疗任务中的功效。其他几项工作在医学图像上调整了基于对比的方法[3, 9, 56]。另一方面，大量的工作集中在恢复性方法上，可分为仅恢复性方法[10,57]、恢复性和对抗性方法[43]，以及判别性和恢复性方法[26,40,55]。在这些群体中，最近关于TransVW的研究[25,26]通过将判别性和恢复性组件结合到一个单一的SSL框架中，显示了其优势。DiRA通过展示两个关键的进展而区别于所有以前的工作。(1)在一个统一的框架中同时采用鉴别性、恢复性和对抗性学习；(2)提供一个与现有的鉴别性和恢复性学习兼容的通用表示学习框架。

## AdCo

**Adversarial Contrast for Efficient Learning of Unsupervised Representations from Self-Trained Negative Adversaries**

CVPR 2021

- Paper: https://arxiv.org/abs/2011.08435

